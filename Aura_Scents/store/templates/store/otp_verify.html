{% extends 'store/base.html' %}
{% load static %}
{% block title %}OTP Verification - Aura Scents{% endblock %}

{% block content %}
<section class="min-h-[80vh] flex items-start justify-center py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-md w-full bg-white p-8 rounded-lg shadow-lg space-y-6 mt-12 md:mt-24">

    <div class="text-center">
      <h2 class="text-2xl font-playfair font-bold text-purple-800">OTP Verification</h2>
      <p class="mt-2 text-gray-600 text-sm">An OTP has been sent to your email.</p>
    </div>

    {% if messages %}
      <ul class="text-sm text-red-600">
        {% for message in messages %}
          <li>{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    <form method="POST" class="space-y-4">
      {% csrf_token %}
      <div>
        <label for="otp" class="block text-sm font-medium text-gray-700">Enter OTP</label>
        <input id="otp" name="otp" type="text" placeholder="Enter OTP" required
          class="w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm">
      </div>

      <div class="text-center text-sm space-y-1">
        <p class="text-gray-600">Didnâ€™t get the OTP?</p>
        <a href="{% url 'otp_resend' user.id %}" class="text-purple-700 hover:text-purple-500 font-medium">Resend OTP</a>
      </div>

      <div class="text-center text-gray-600 text-sm">
        OTP valid for <span id="countdown" class="font-semibold text-purple-700">05:00</span>
      </div>

      <button type="submit"
        class="w-full py-2 px-4 bg-pink-500 hover:bg-pink-600 text-white font-semibold rounded-md transition-all duration-300">
        Verify
      </button>
    </form>
  </div>
</section>

<script>
  const countdownEl = document.getElementById('countdown');
  let timeLeft = 300;

  function formatTime(seconds) {
    const min = String(Math.floor(seconds / 60)).padStart(2, '0');
    const sec = String(seconds % 60).padStart(2, '0');
    return `${min}:${sec}`;
  }

  function updateCountdown() {
    countdownEl.textContent = formatTime(timeLeft);
    if (timeLeft > 0) {
      timeLeft--;
    } else {
      clearInterval(timer);
      countdownEl.textContent = 'Expired';
      countdownEl.classList.add('text-red-600');
    }
  }

  updateCountdown();
  const timer = setInterval(updateCountdown, 1000);
</script>
{% endblock %}
